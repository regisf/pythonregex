(function(){var r,h,k,s,t,f,u,v,n,w,x,y,z=function(b,a){return function(){return b.apply(a,arguments)}},A={}.hasOwnProperty,p=function(b,a){function g(){this.constructor=b}for(var l in a)A.call(a,l)&&(b[l]=a[l]);g.prototype=a.prototype;b.prototype=new g;b.__super__=a.prototype;return b};$(function(){return $("[data-delete-confirm]").on("click",function(){var b,a;a=$(this).data("rel");b=$("[data-dialog-url]");return b.attr("href",b.attr("href")+a+"/")})});t=function(){function b(){var a,g,b;this.view=
new y;this.optionsDialog=new w;this.contactDialog=new r;this.saveDialog=new s;this.saveDialog.connect(h.Signals.SaveSuccess,function(a){return function(g){var b;b=$("#src_regex").val();return a.model.saveRegex(g,b)}}(this));$("#src_evaluate").on("click",this.evaluate.bind(this));this.model=window.WebSocket?new v:new u;this.model.connect(k.Signals.SendError,function(a){return function(a){new f("Error","Unable to connect the server "+a)}}(this)).connect(k.Signals.SendSuccess,function(a){return function(a){a.success?
$("#dest_result").html("<pre><code>"+a.content+"</code></pre>"):new f("Error",a.error)}}(this)).connect(h.Signals.SaveSuccess,function(a){return function(g){a.saveDialog.close();a.view.displaySuccessMessage("Regular expression saved with success")}}(this));g=0;for(b=messages.length;g<b;g++)a=messages[g],$.UIkit.notify({message:a.message,status:a.level?"danger":"success",pos:"top-center",timeout:3E3});window.onunload=this.saveTempRegex.bind(this);this.restoreTempRegex();$("#main").on("click","#save-regex",
this.saveRegex.bind(this))}b.prototype.getModel=function(){return this.model};b.prototype.saveRegex=function(){return this};b.prototype.saveTempRegex=function(){window.localStorage.setItem("regex",$("#src_regex").val());window.localStorage.setItem("sourcetext",$("#sourcetext").val());return this};b.prototype.restoreTempRegex=function(){var a;a=window.localStorage.getItem("regex");null!==a&&void 0!==a&&($("#src_regex").val(a),window.localStorage.removeItem("regex"));a=window.localStorage.getItem("sourcetext");
null!==a&&void 0!==a&&($("#sourcetext").val(a),window.localStorage.removeItem("sourcetext"));return this};b.prototype.evaluate=function(){var a,g,b,d,c,e,m,q;c=$.trim($("#src_regex").val());g=$.trim($("#sourcetext").val());b=$("input[name=regex]:checked").val();d=[];$("#displaycommand").is("checked")&&d.push("displaycommand");q=$("input[type=checkbox]:checked","#regex_flags");e=0;for(m=q.length;e<m;e++)a=q[e],d.push($(a).data("name"));c.length?g.length?(e=a=void 0,$("#sub").is(":checked")?e=$("input[name=replacement]").val():
$("#subn").is(":checked")?(a=parseInt($("input[name=maxreplacement]").val()),e=$("input[name=subnreplacement]").val()):$("#split").is(":checked")&&(a=$("#maxsplit").is(":checked")),this.model.sendRegex(c,g,b,d,e,a)):new f("Error","You must enter some text to evaluate"):new f("Error","No regular expression entered");return this};return b}();$(function(){$("#main").css("min-height",$(document).height()-$("footer#footer").height()-70);new t});n=function(){function b(){this.sig=[]}b.prototype.connect=
function(a,b){a&&b&&this.sig.push({signal:a,slot:b});return this};b.prototype.emit=function(a,b){var l,d,c,e;e=this.sig;d=0;for(c=e.length;d<c;d++)l=e[d],l.signal===a&&l.slot(b);return this};return b}();r=function(){function b(){this.validateForm=z(this.validateForm,this);var a;a=$("#contact");this.emailField=a.find("input[name=email]");this.nameField=a.find("input[name=name]");this.answerField=a.find("input[name=question]");this.messageField=a.find("textarea[name=message]");a.on("uk.modal.show",
function(a){return function(){a.emailField.val("");a.emailField.removeClass("uk-form-danger");a.nameField.val("");a.nameField.removeClass("uk-form-danger");a.answerField.val("");a.answerField.removeClass("uk-form-danger");a.messageField.val("");return a.messageField.removeClass("uk-form-danger")}}(this));a.find("[data-send]").on("click",this.validateForm)}b.prototype.validateForm=function(a){var b;b=[];0===$.trim(this.emailField.val()).length?(this.emailField.addClass("uk-form-danger"),b.push("The email is empty")):
this.emailField.removeClass("uk-form-danger");0===$.trim(this.nameField.val()).length?(this.nameField.addClass("uk-form-danger"),b.push("The name is empty")):this.nameField.removeClass("uk-form-danger");0===$.trim(this.answerField.val()).length?(this.answerField.addClass("uk-form-danger"),b.push("The answer is empty")):this.answerField.val()!==$("#result").val()?(this.answerField.addClass("uk-form-danger"),b.push("This isn't the good answer")):this.answerField.removeClass("uk-form-danger");0===$.trim(this.messageField.val()).length?
(this.messageField.addClass("uk-form-danger"),b.push("The message is empty")):this.messageField.removeClass("uk-form-danger");b.length?(a.preventDefault(),alert("There is one or more error\n\n"+b.join("\n"))):(a=new FormData(document.getElementById("contactform")),$("#form-container").slideUp("fast",function(a){return function(){$("#wheel-container").removeClass("uk-hidden");return a.addClass("uk-hidden")}}(this)),a=$.ajax({url:"/contact",type:"POST",data:a,processData:!1,contentType:!1}),a.always(function(a){$("#wheel-container").addClass("uk-hidden");
return $("#form-container").removeClass("uk-hidden")}),a.done(function(a){var b;return a.match(/^error/)?(b=new $.UIkit.modal.Modal("#connection-error"),document.getElementById("connection-error-msg").innerHTML=a,b.show()):(new $.UIkit.modal.Modal("#send-success")).show()}),a.fail(function(a){var b;b=new $.UIkit.modal.Modal("#connection-error");document.getElementById("connection-error-msg").innerHTML=a.responseText;return b.show()}))};return b}();f=function(){return function(b,a){$("#messagedialog").find("[data-content]").html(a);
$("#messagedialog").find("[data-title]").html(b);(new $.UIkit.modal("#messagedialog")).show()}}();u=function(b){function a(){a.__super__.constructor.call(this)}p(a,b);a.prototype.sendRegex=function(a,b,d,c,e,m){return $.getJSON("/wsa/",{json:JSON.stringify({regex:a,content:b,method:d,options:c,sub:e||null,count:m||null})}).fail(function(a){return function(b){return a.emit(k.Signals.SendError,b.responseText)}}(this)).done(function(a){return function(b){return a.emit(k.Signals.SendSuccess,b)}}(this))};
a.prototype.saveRegex=function(a,b){alert(a);return alert(b)};return a}(n);v=function(b){function a(){a.__super__.constructor.call(this)}p(a,b);a.prototype.sendRegex=function(a,b,d,c,e,m){var h,f;h={action:"evaluate",regex:a,content:b,method:d,options:c,flags:c,sub:e||null,count:m||null};f=new WebSocket("ws://localhost:8888/ws/");f.onmessage=function(a){return function(b){a.emit(k.Signals.SendSuccess,JSON.parse(b.data))}}(this);f.onerror=function(a){return function(b){a.emit(k.Signals.SendError,b)}}(this);
return f.onopen=function(a){return function(a){f.send(JSON.stringify(h))}}(this)};a.prototype.saveRegex=function(a,b){var d,c;d={action:"save",name:a,regex:b};c=new WebSocket("ws://localhost:8888/ws/");c.onmessage=function(a){return function(b){a.emit(h.Signals.SaveSuccess,JSON.parse(b.data))}}(this);c.onerror=function(a){return function(b){a.emit(h.Signals.SaveError,b)}}(this);return c.onopen=function(a){return function(a){return c.send(JSON.stringify(d))}}(this)};return a}(n);x=function(){function b(){var a;
this.shortTag=this.liveEvaluation=this.evaluateOnChange=!1;this.tags={debug:!1,ignoreCase:!1,multiline:!1,dotAll:!1,unicode:!1,verbose:!1};window.localStorage&&(a=window.localStorage,this.evaluateOnChange=a.getItem(!1),this.liveEvaluation=a.getItem(!1),this.shortTag=a.getItem(!1),this.tags.debug=a.getItem(!1),this.tags.ignoreCase=a.getItem(!1),this.tags.multiline=a.getItem(!1),this.tags.dotAll=a.getItem(!1),this.tags.unicode=a.getItem(!1),this.tags.verbose=a.getItem(!1))}b.prototype.change=function(){var a;
this.evaluateOnChange=$("#opt_change").is(":checked");this.liveEvaluation=$("#opt_typing").is(":checked");this.shortTag=$("#opt_short").is(":checked");this.tags.debug=$("#re_debug").is(":checked");this.tags.ignoreCase=$("#re_ignore").is(":checked");this.tags.multiline=$("#re_multiline").is(":checked");this.tags.dotAll=$("#re_dotall").is(":checked");this.tags.unicode=$("#re_unicode").is(":checked");this.tags.verbose=$("#re_verbose").is(":checked");if(window.localStorage)return a=window.localStorage,
a.setItem("opt_change",!0===this.evaluateOnChange?"1":"0"),a.setItem("opt_typing",!0===this.liveEvaluation?"1":"0"),a.setItem("opt_short",!0===this.shortTag?"1":"0"),a.setItem("re_debug",!0===this.tags.debug?"1":"0"),a.setItem("re_ignore",!0===this.tags.ignoreCase?"1":"0"),a.setItem("re_multiline",!0===this.tags.multiline?"1":"0"),a.setItem("re_dotall",!0===this.tags.dotAll?"1":"0"),a.setItem("re_unicode",!0===this.tags.unicode?"1":"0"),a.setItem("re_verbose",!0===this.tags.verbose?"1":"0")};return b}();
w=function(){function b(){this.model=new x;$("#options").on("click","[data-ok]",this.model.change.bind(this.model));$("#options").on("uk-model-show",this.onOpen.bind(this))}b.prototype.onOpen=function(){$("#opt_change").attr("checked",this.model.evaluateOnChange);$("#opt_typing").attr("checked",this.model.liveEvaluation);$("#opt_short").attr("checked",this.model.shortTag);$("#re_debug").attr("checked",this.model.tags.debug);$("#re_ignore").attr("checked",this.model.tags.ignoreCase);$("#re_multiline").attr("checked",
this.model.tags.multiline);$("#re_dotall").attr("checked",this.model.tags.dotAll);$("#re_unicode").attr("checked",this.model.tags.unicode);return $("#re_verbose").attr("checked",this.model.tags.verbose)};return b}();s=function(b){function a(){a.__super__.constructor.call(this);this.saveDialog=$("#savedialog");this.saveDialog.find("button#save").on("click",this.onSave.bind(this));this.inputName=this.saveDialog.find("input[name=name]");this.saveDialog.on("uk.modal.show",function(a){return function(){a.inputName.val("");
a.inputName.focus();a.saveDialog.find("i.uk-icon-spin").addClass("uk-hidden");a.saveDialog.find("i.uk-icon-times").removeClass("uk-hidden")}}(this))}p(a,b);a.prototype.onSave=function(){var a;a=$.trim(this.inputName.val());""!==a&&(this.saveDialog.find("i").toggleClass("uk-hidden"),this.emit(h.Signals.SaveSuccess,a))};a.prototype.close=function(){return $.UIkit.modal(this.saveDialog).hide()};return a}(n);k={Signals:{SendSuccess:"model.regex.success",SendError:"model.regex.error",SocketClosed:"model.socket.closed",
SaveSuccess:"model.save.success",SaveError:"model.save.error"}};h={Signals:{SaveSuccess:"dialog.regex.save.success",SaveError:"dialog.regex.save.error"}};y=function(){function b(){this.slideDown=!0;this.storejQueryObjects();this.forceCheck();this.prepareUI();this.connectUI()}b.prototype.forceCheck=function(){var a,b,f,d,c;d=$("input[type=radio]:checked");c=[];b=0;for(f=d.length;b<f;b++)switch(a=d[b],a.getAttribute("id")){case "split":c.push(this.displaySplitOptions());break;case "sub":c.push(this.displaySubOptions());
break;case "subn":c.push(this.displaySubnOptions());break;case "displaycommand":c.push(this.displayCommandLine());break;default:c.push(void 0)}return c};b.prototype.storejQueryObjects=function(){this.splitOptions=$("#splitoptions");this.subnOptions=$("#subnoptions");this.subOptions=$("#suboptions");this.inputRadioSplit=$("input#split");this.inputRadioSub=$("input#sub");this.inputRadioSubn=$("input#subn");this.inputFieldReplacement=$("input[name=replacement]");this.inputFieldSubnreplacement=$("input[name=subnreplacement]");
this.inputFieldMaxreplacement=$("input[name=maxreplacement]");return this.inputFieldMaxsplit=$("input[name=maxsplit]")};b.prototype.prepareUI=function(){this.splitOptions.hide();this.subnOptions.hide();return this.subOptions.hide()};b.prototype.connectUI=function(){$("input[type=radio]").on({click:function(a){return $("[data-option]").hide()}});this.inputRadioSplit.on("click",this.displaySplitOptions.bind(this));this.inputRadioSub.on("click",this.displaySubOptions.bind(this));this.inputRadioSubn.on("click",
this.displaySubnOptions.bind(this));return $("input#displaycommand").on("click",this.displayCommandLine.bind(this))};b.prototype.displaySplitOptions=function(a){this.inputFieldMaxsplit.val(0);return this.splitOptions.show()};b.prototype.displaySubOptions=function(a){this.inputFieldReplacement.val("");return this.subOptions.show()};b.prototype.displaySubnOptions=function(a){this.inputFieldSubnreplacement.val("");this.inputFieldMaxreplacement.val(0);return this.subnOptions.show()};b.prototype.displayCommandLine=
function(a){"Not yet evaluated"!==$("#dest_result").html()&&$("#src_evaluate").trigger("click");return null};b.prototype.displaySuccessMessage=function(a){return $.UIkit.notify({message:a,status:"success",timeout:5E3,pos:"top-center"})};return b}()}).call(this);
